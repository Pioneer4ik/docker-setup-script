#!/bin/bash

# –õ–æ–≥–æ—Ç–∏–ø
channel_logo() {
  echo -e '\033[0;32m' # –°–∞–ª–∞—Ç–æ–≤—ã–π —Ü–≤–µ—Ç
  echo -e '‚ñà‚ñà‚ñí   ‚ñà‚ñì ‚ñà‚ñà‚ñì    ‚ñÑ‚ñÑ‚ñÑ       ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñÑ   ‚ñà‚ñà ‚ñÑ‚ñà‚ñÄ ‚ñà‚ñà ‚ñÑ‚ñà‚ñÄ ‚ñÑ‚ñÑ‚ñÑ‚ñÑ    ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñí‚ñà   ‚ñà‚ñí ‚ñà‚ñà‚ñì‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ'
  echo -e '‚ñì‚ñà‚ñà‚ñë   ‚ñà‚ñí‚ñì‚ñà‚ñà‚ñí   ‚ñí‚ñà‚ñà‚ñà‚ñà‚ñÑ    ‚ñí‚ñà‚ñà‚ñÄ ‚ñÄ‚ñà   ‚ñà‚ñà‚ñÑ‚ñà‚ñí   ‚ñà‚ñà‚ñÑ‚ñà‚ñí ‚ñì‚ñà‚ñà‚ñà‚ñà‚ñà‚ñÑ  ‚ñì‚ñà   ‚ñÄ ‚ñí‚ñà ‚ñà‚ñí‚ñë‚ñì‚ñà‚ñà‚ñí‚ñí‚ñà‚ñà‚ñÄ ‚ñà‚ñà‚ñå'
  echo -e ' ‚ñì‚ñà‚ñà  ‚ñà‚ñí‚ñë‚ñí‚ñà‚ñà‚ñë   ‚ñí‚ñà‚ñà  ‚ñÄ‚ñà‚ñÑ  ‚ñí‚ñì‚ñà    ‚ñÑ ‚ñì‚ñà‚ñà‚ñà‚ñÑ‚ñë  ‚ñì‚ñà‚ñà‚ñà‚ñÑ‚ñë ‚ñí‚ñà‚ñà‚ñí ‚ñÑ‚ñà‚ñà ‚ñí‚ñà‚ñà‚ñà   ‚ñí‚ñà‚ñí‚ñë ‚ñë‚ñí‚ñà‚ñà‚ñí‚ñë‚ñà‚ñà   ‚ñà‚ñå'
  echo -e '  ‚ñí‚ñà‚ñà ‚ñà‚ñë‚ñë‚ñí‚ñà‚ñà‚ñë   ‚ñë‚ñà‚ñà‚ñÑ‚ñÑ‚ñÑ‚ñÑ‚ñà‚ñà ‚ñí‚ñì‚ñì‚ñÑ ‚ñÑ‚ñà‚ñà‚ñí‚ñì‚ñà‚ñà ‚ñà‚ñÑ  ‚ñì‚ñà‚ñà ‚ñà‚ñÑ ‚ñí‚ñà‚ñà‚ñë‚ñà‚ñÄ   ‚ñí‚ñì‚ñà  ‚ñÑ ‚ñí‚ñà‚ñë   ‚ñë‚ñà‚ñà‚ñë‚ñë‚ñì‚ñà‚ñÑ   ‚ñå'
  echo -e '   ‚ñí‚ñÄ‚ñà‚ñë  ‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñì‚ñà   ‚ñì‚ñà‚ñà‚ñí‚ñí ‚ñì‚ñà‚ñà‚ñà‚ñÄ ‚ñë‚ñí‚ñà‚ñà‚ñí ‚ñà‚ñÑ ‚ñí‚ñà‚ñà‚ñí ‚ñà‚ñÑ‚ñë‚ñì‚ñà  ‚ñÄ‚ñà‚ñì ‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñí‚ñë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñí‚ñà‚ñà‚ñí‚ñë‚ñí‚ñà‚ñà‚ñà‚ñà‚ñì '
  echo -e '   ‚ñë ‚ñê‚ñë  ‚ñë ‚ñí‚ñë‚ñì  ‚ñë‚ñí‚ñí   ‚ñì‚ñí‚ñà‚ñë‚ñë ‚ñë‚ñí ‚ñí  ‚ñë‚ñí ‚ñí‚ñí ‚ñì‚ñí‚ñí ‚ñí‚ñí ‚ñì‚ñí‚ñë‚ñí‚ñì‚ñà‚ñà‚ñà‚ñÄ‚ñí ‚ñë‚ñë ‚ñí‚ñë ‚ñë‚ñë ‚ñí‚ñë‚ñì  ‚ñë‚ñì ‚ñë ‚ñí‚ñí‚ñì  ‚ñí '
  echo -e '   ‚ñë ‚ñë‚ñë  ‚ñë ‚ñë ‚ñí  ‚ñë ‚ñí   ‚ñí‚ñí ‚ñë  ‚ñë  ‚ñí   ‚ñë ‚ñë‚ñí ‚ñí‚ñë‚ñë ‚ñë‚ñí ‚ñí‚ñë‚ñí‚ñë‚ñí   ‚ñë   ‚ñë ‚ñë  ‚ñë‚ñë ‚ñë ‚ñí  ‚ñë‚ñí ‚ñë ‚ñë ‚ñí  ‚ñí '
  echo -e '     ‚ñë‚ñë    ‚ñë ‚ñë    ‚ñë   ‚ñí   ‚ñë        ‚ñë ‚ñë‚ñë ‚ñë ‚ñë ‚ñë‚ñë ‚ñë  ‚ñë    ‚ñë     ‚ñë     ‚ñë ‚ñë   ‚ñí ‚ñë ‚ñë ‚ñë  ‚ñë '
  echo -e '      ‚ñë      ‚ñë  ‚ñë     ‚ñë  ‚ñë‚ñë ‚ñë      ‚ñë  ‚ñë   ‚ñë  ‚ñë    ‚ñë          ‚ñë  ‚ñë    ‚ñë  ‚ñë‚ñë     ‚ñë    '
  echo -e '     ‚ñë                       ‚ñë                     ‚ñë                          ‚ñë      '
  echo -e '\033[0m'
  echo -e "\n–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–æ–¥—ã Titan Edge!"
}

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–¥—ã Titan Edge
setup_node() {
  echo "–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é –Ω–æ–¥—É Titan Edge..."
  
  # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
  sudo apt install -y ca-certificates curl gnupg lsb-release && \
  curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg && \
  echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null && \
  sudo apt update && sudo apt install -y docker-ce docker-ce-cli containerd.io && \
  sudo usermod -aG docker $USER && \
  newgrp docker

  # –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ Titan Edge
  docker pull nezha123/titan-edge
  mkdir -p ~/.titanedge
  docker run --network=host -d -v ~/.titanedge:/root/.titanedge nezha123/titan-edge

  echo "–ù–æ–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏ –∑–∞–ø—É—â–µ–Ω–∞."
}

# –ü—Ä–∏–≤—è–∑–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
bind_device() {
  read -p "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∫–ª—é—á –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: " hash_key
  docker run --rm -it -v ~/.titanedge:/root/.titanedge nezha123/titan-edge bind --hash=$hash_key https://api-test1.container1.titannet.io/api/v2/device/binding
}

# –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é
while true; do
  clear
  channel_logo
  sleep 1
  echo -e "\n–ú–µ–Ω—é:"
  echo "1. üöÄ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ù–û–î–£"
  echo "2. üîë –ü—Ä–∏–≤—è–∑–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ"
  echo "3. üö™ –í—ã–π—Ç–∏"
  echo -e "\n"
  read -p "–í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç –º–µ–Ω—é: " choice

  case $choice in
    1)
      setup_node
      ;;
    2)
      bind_device
      ;;
    3)
      echo "–í—ã—Ö–æ–¥ –∏–∑ —Å–∫—Ä–∏–ø—Ç–∞."
      exit 0
      ;;
    *)
      echo "–ù–µ–≤–µ—Ä–Ω—ã–π –ø—É–Ω–∫—Ç. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä."
      ;;
  esac
done
